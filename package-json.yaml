id: package-json-disclosure

info:
  name: NPM package.json / package-lock.json Disclosure
  author: geeknik,afaq,noraj,pdn-nuclei,0xazanul
  severity: info
  description: Detects exposure of package.json or package-lock.json files.
  tags: config,exposure,node,npm,javascript,disclosure

http:
  - method: GET
    path:
      - "{{BaseURL}}/package.json"
      - "{{BaseURL}}/package-lock.json"
      - "{{BaseURL}}/app/package.json"
      - "{{BaseURL}}/src/package.json"
      - "{{BaseURL}}/client/package.json"
      - "{{BaseURL}}/server/package.json"
      - "{{BaseURL}}/public/package.json"
      - "{{BaseURL}}/static/package.json"
      - "{{BaseURL}}/Package.json"
      - "{{BaseURL}}/PACKAGE.JSON"
      - "{{BaseURL}}/%2epackage.json"
      - "{{BaseURL}}/%2e%2fpackage.json"
      - "{{BaseURL}}/package%2ejson"
      - "{{BaseURL}}/../package.json"
      - "{{BaseURL}}/%2e%2e/package.json"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "application/json"

      - type: word
        part: body
        words:
          - "\"name\""
          - "\"version\""
        condition: and

      - type: word
        part: body
        words:
          - "<html"
          - "404 Not Found"
          - "error"
        negative: true

    extractors:
      - type: regex
        name: project_name
        part: body
        regex:
          - '"name"\s*:\s*"([^"]+)"'

      - type: regex
        name: project_version
        part: body
        regex:
          - '"version"\s*:\s*"([^"]+)"'
